log_format fmt_syslog '[$time_local] $status $remote_addr $http_host "$request" $body_bytes_sent $request_time "$http_user_agent" $remote_user';

map $status $log_is_error { "~^5\d\d"     1; default 0; }
map $status $log_is_warn  { "~^4[0-8]{2}" 1; default 0; }
map $status $log_is_info  { "~^[1-3]\d\d" 1; default 0; }

access_log syslog:server=unix:/dev/log,nohostname,facility=local2,severity=error fmt_syslog if=$log_is_error;
access_log syslog:server=unix:/dev/log,nohostname,facility=local2,severity=warn  fmt_syslog if=$log_is_warn;
# access_log syslog:server=unix:/dev/log,nohostname,facility=local2,severity=info  fmt_syslog if=$log_is_info;
access_log /var/log/nginx/access.log fmt_syslog if=$log_is_info;

error_log syslog:server=unix:/dev/log,nohostname,facility=local2 error;
